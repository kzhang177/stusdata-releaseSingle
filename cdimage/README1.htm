<html>

<head>
<meta http-equiv="Content-Language" content="zh-cn">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>自己做“N合一”光盘</title>
</head>

<body>

<p style="line-height: 150%; margin-top: 10; margin-bottom: 10"><b><font size="2">自己做</font><font face="Verdana" size="2">“N</font><font size="2">合一</font><font face="Verdana" size="2">”</font><font size="2">光盘</font></b></p>
<p align="left"><font size="2">这段时间流行了一阵</font><font face="Verdana" size="2">“N</font><font size="2">合一</font><font face="Verdana" size="2">”</font><font size="2">风，最早是</font><font face="Verdana" size="2">WIN2000</font><font size="2">的</font><font face="Verdana" size="2">PRO</font><font size="2">，</font><font face="Verdana" size="2">SERVER</font><font size="2">和</font><font face="Verdana" size="2">ADVSERVER</font><font size="2">三个版本做成一张光盘，刚开始我还以为是简单的把三个系统的安装盘刻在一张上面，后来大概算了一下，少说也有</font><font face="Verdana" size="2">900M-1G</font><font size="2">的数据，不太可能。下了一张来看看，发现做法非常新鲜：<br>
<br>
其实</font><font face="Verdana" size="2">WIN2000</font><font size="2">的三个版本的安装盘中，有大量的文件是相同的，特别是语言包</font><font face="Verdana" size="2">/</font><font size="2">字库（</font><font face="Verdana" size="2">I386\LANG</font><font size="2">目录）以及写字板等自带应用程序，以及那个</font><font face="Verdana" size="2">50M</font><font size="2">的</font><font face="Verdana" size="2">driver.cab</font><font size="2">。不同的只是相对少数的系统文件。这种</font><font face="Verdana" size="2">N</font><font size="2">合一光盘将</font><font face="Verdana" size="2">ISO</font><font size="2">映象经过特殊处理，重复的文件，实际数据在光盘上只有一份，通过类似于修改光盘目录表的办法，让不同的目录</font><font face="Verdana" size="2">/</font><font size="2">文件指向相同的数据区。完成</font><font face="Verdana" size="2">ISO</font><font size="2">修改后再刻成光盘。这样，既省了空间，又让每个目录看起来仍然独立、完整。<br>
<br>
那么到底有多少相同呢？我自己做了个实验，我有一个</font><font face="Verdana" size="2">WIN2K PRO</font><font size="2">安装目录和一个</font><font face="Verdana" size="2">ADV SERVER</font><font size="2">安装目录，分别是</font><font face="Verdana" size="2">260M</font><font size="2">和</font><font face="Verdana" size="2">280M</font><font size="2">左右。（为了省空间，我去掉了除简</font><font face="Verdana" size="2">/</font><font size="2">繁体中文外的其它语言包，象韩文日文阿拉伯文，我这辈子都用不到）。两个目录如果简单的刻在一张盘上，将占</font><font face="Verdana" size="2">540M</font><font size="2">左右的空间。而用</font><font face="Verdana" size="2">N</font><font size="2">合一的方法，</font><font face="Verdana" size="2">“</font><font size="2">相同文件只处理一次</font><font face="Verdana" size="2">”</font><font size="2">，合并下来只有</font><font face="Verdana" size="2">340M</font><font size="2">左右。照这个数字看来，二者有</font><font face="Verdana" size="2">70-75%</font><font size="2">是相同的！不同部分只占各自的</font><font face="Verdana" size="2">25%-30%</font><font size="2">！依此数字估算，就算将</font><font face="Verdana" size="2">SERVER</font><font size="2">也加进去，最后的大小也应该只有</font><font face="Verdana" size="2">400-450M</font><font size="2">，相对于简单相加的</font><font face="Verdana" size="2">800M</font><font size="2">，几乎少了一半。如果你不想将三个差不多的</font><font face="Verdana" size="2">WIN2000</font><font size="2">分别用三张</font><font face="Verdana" size="2">CDR</font><font size="2">保存的话，可以考虑自己做个</font><font face="Verdana" size="2">N</font><font size="2">合一光盘。<br> 
<br>
说到这里不仅要提一下</font><font face="Verdana" size="2">DOS/WIN</font><font size="2">文件系统的落后。</font><font face="Verdana" size="2">UNIX/LINUX</font><font size="2">从最开始就提供了符号连接的功能，一个简单的</font><font face="Verdana" size="2">ln</font><font size="2">命令就可以完成上面的工作，而在</font><font face="Verdana" size="2">DOS/WIN</font><font size="2">下，这种操作必须借助专门的软件通过修改</font><font face="Verdana" size="2">ISO</font><font size="2">进行，而且这种结构还不能存在于硬盘上，因为它在所有针对</font><font face="Verdana" size="2">DOS/WIN</font><font size="2">的磁盘检查软件看来，都是</font><font face="Verdana" size="2">“</font><font size="2">交叉连接</font><font face="Verdana" size="2">”</font><font size="2">，会被更正。<br>
<br>
好了，别扯远了。话说回来，理解这种方式很容易，实际做起来呢？关键是</font><font face="Verdana" size="2">“</font><font size="2">相同文件</font><font face="Verdana" size="2">”</font><font size="2">是怎么判断。靠人工是很麻烦的。实际上微软内部提供了一个工具，叫</font><font face="Verdana" size="2">CDIMAGE</font><font size="2">，专门干这个。加上一个</font><font face="Verdana" size="2">-o</font><font size="2">参数，就可以实现</font><font face="Verdana" size="2">“</font><font size="2">自动优化</font><font face="Verdana" size="2">”</font><font size="2">的功能。</font><font face="Verdana" size="2">MS</font><font size="2">很多内部发行版本，都是用这个办法</font><font face="Verdana" size="2">“</font><font size="2">挤</font><font face="Verdana" size="2">”</font><font size="2">在一张盘上。这个小工具解压只有</font><font face="Verdana" size="2">70K</font><font size="2">。
<br>
当然它不光是用来做</font><font face="Verdana" size="2">WIN2000</font><font size="2">的</font><font face="Verdana" size="2">N</font><font size="2">合一。对所有</font><font face="Verdana" size="2">“</font><font size="2">大量文件重复</font><font face="Verdana" size="2">”</font><font size="2">的情况，用它都可以发挥极大作用。不过</font><font face="Verdana" size="2">……</font><font size="2">好象这种情况不多</font><font face="Verdana" size="2">……</font><font size="2">大家举点例子？<br>
<br>
具体做法：<br>
<br>
</font><font face="Verdana" size="2">1</font><font size="2">、建一个目录，把它看成是你要做的光盘的根目录，把所有要放上去的内容全弄进去，比如，这个目录叫</font><font face="Verdana" size="2">c:\ewin3in1</font><font size="2">，里面分别有<br>
<br>
</font><font face="Verdana" size="2">c:\ewin3in1\pro<br>
c:\ewin3in1\server<br>
c:\ewin3in1\advserver<br>
</font><font size="2"><br>
目录，分别对应三个</font><font face="Verdana" size="2">WIN2000</font><font size="2">版本。现在查看目录属性，应该在</font><font face="Verdana" size="2">800M</font><font size="2">或更多，无法放在一张光盘上。<br>
<br>
</font><font face="Verdana" size="2">2</font><font size="2">、现在用</font><font face="Verdana" size="2">CDIMAGE</font><font size="2">程序，在另一目录（你想产生</font><font face="Verdana" size="2">ISO</font><font size="2">文件的目录）中运行：<br>
<br>
</font><font face="Verdana" size="2">cdimage -lWin2K3IN1 -t08/22/00,00:00:00 -h -n -o -m c:\ewin2k My3IN1.ISO<br>  
<br>
</font><font size="2">直接运行</font><font face="Verdana" size="2">CDIMAGE</font><font size="2">将显示参数说明。下面简单解释一下常用参数意义：<br>
<br>
</font><font face="Verdana" size="2">-l : </font><font size="2"> （是</font><font face="Verdana" size="2">JKL</font><font size="2">的</font><font face="Verdana" size="2">L</font><font size="2">，不是</font><font face="Verdana" size="2">IBM</font><font size="2">的</font><font face="Verdana" size="2">I</font><font size="2">）这是光盘的卷标<br> 
</font><font face="Verdana" size="2">-t : </font><font size="2"> 将所有文件设成指定的时间，看起来很专业<br> 
</font><font face="Verdana" size="2">-h : </font><font size="2"> 包括隐藏文件<br> 
</font><font face="Verdana" size="2">-n : </font><font size="2"> 允许长文件名<br> 
<br>
</font><font face="Verdana" size="2">-o : </font><font size="2"> 这是最重要的，</font><font face="Verdana" size="2">CDIMAGE</font><font size="2">的精华就是它。自动判断重复文件，对重复文件只处理一次，并自动修改相关的文件指向。默认是使用文件大小和</font><font face="Verdana" size="2">MD5</font><font size="2">算法进行比较（我也不太懂，大概是和</font><font face="Verdana" size="2">CHECKSUM</font><font size="2">差不多概念的方法吧）从概率角度来看准确性相当高，但并不是</font><font face="Verdana" size="2">“</font><font size="2">逐字节对比</font><font face="Verdana" size="2">”</font><font size="2">。如果你要求逐字节对比，用</font><font face="Verdana" size="2">-oc</font><font size="2">参数。不过速度极慢。<br> 
<br>
</font><font face="Verdana" size="2">-m : </font><font size="2"> 不加这个参数的话，将不能产生大于</font><font face="Verdana" size="2">650M</font><font size="2">的</font><font face="Verdana" size="2">ISO</font><font size="2">映象<br> 
<br>
</font><font face="Verdana" size="2">c:\ewin2k : </font><font size="2"> 这是光盘的根目录。</font><font face="Verdana" size="2">CDIMAGE</font><font size="2">将以此目录开始构造光盘目录结构，硬盘上的</font><font face="Verdana" size="2">c:\ewin2k\pro</font><font size="2">将变成光盘的</font><font face="Verdana" size="2">x:\pro<br> 
<br>
My3IN1.ISO : </font><font size="2"> 这是最后生成的</font><font face="Verdana" size="2">ISO</font><font size="2">文件的名字。它已经是优化后的了。<br> 
<br>
</font><font face="Verdana" size="2">3</font><font size="2">、最后只需用烧录软件（如</font><font face="Verdana" size="2">EASY CD CREATOR</font><font size="2">的</font><font face="Verdana" size="2">CREATE DISK FROM IMAGE</font><font size="2">）将</font><font face="Verdana" size="2">ISO</font><font size="2">刻成光盘即可。<br> 
<br>
至此我们的</font><font face="Verdana" size="2">N</font><font size="2">合一就做完了。当然这张盘只是简单的将三个安装目录放在一起，而且不能启动。比较理想的情况是，将光盘做成象</font><font face="Verdana" size="2">2000</font><font size="2">正版那样自动启动并开始安装的（这个已经有人做到了），更理想的情况是开机出现菜单，可以选择安装</font><font face="Verdana" size="2">PRO/SERVER</font><font size="2">或</font><font face="Verdana" size="2">ADVSERVER</font><font size="2">，然后自动调用相应的安装程序。</font><font face="Verdana" size="2">
<br>
</font><font size="2">这种盘当然也有缺点，而且是显而易见的：<br>
<br>
</font><font face="Verdana" size="2">1</font><font size="2">、如果光盘有某个地方损坏，刚好又是大家</font><font face="Verdana" size="2">“</font><font size="2">共享</font><font face="Verdana" size="2">”</font><font size="2">的系统文件，那么可能</font><font face="Verdana" size="2">3</font><font size="2">个</font><font face="Verdana" size="2">WIN2000</font><font size="2">都将报废，无法安装。普通光盘只是损坏那个文件所属的那一个版本。<br>
<br>
</font><font face="Verdana" size="2">2</font><font size="2">、最好要有光盘刻录机，这种</font><font face="Verdana" size="2">ISO</font><font size="2">镜象，用</font><font face="Verdana" size="2">WINIMAGE</font><font size="2">解是没有意义的，</font><font face="Verdana" size="2">WINIMAGE</font><font size="2">并不懂得这种修改过的结构，它将按目录表把所有文件解到硬盘，相同文件被复制了若干份。相当于还原成优化之前的状态。象那个</font><font face="Verdana" size="2">EWIN 6</font><font size="2">合一，解开后好象有</font><font face="Verdana" size="2">1.9G</font><font size="2">左右。<br> 
<br>
不过相对来说这些缺点都不重要。<br>
<br>
<br>
别小看这些小东西，很难找<br>
 </font>
<p align="right"><b><font size="4">Z-Ware</font></b></p>
<font size="2">
<br>
 </font>

</body>

</html>
